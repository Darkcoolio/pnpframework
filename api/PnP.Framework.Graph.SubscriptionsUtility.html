<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Class SubscriptionsUtility
   | PnP Framework </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Class SubscriptionsUtility
   | PnP Framework ">
    <meta name="generator" content="docfx 2.59.3.0">
    <meta name="description" content="The PnP Framework is a .NET Standard 2.0 / .NET 5.0 / .NET 6.0 / .NET 7.0 library targeting Microsoft 365 containing the PnP Provisioning engine and a ton of other useful extensions.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
    <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "etrmmrwwrp");
  </script>
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="PnP.Framework.Graph.SubscriptionsUtility">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/pnpframework/blob/dev/src/lib/PnP.Framework/Graph/SubscriptionsUtility.cs/#L13" title="View Source" class="view-source-lg"><i class="fa fa-code"></i></a>
                      <a href="https://github.com/pnp/pnpframework/new/dev/apiSpec/new?filename=PnP_Framework_Graph_SubscriptionsUtility.md&amp;value=---%0Auid%3A%20PnP.Framework.Graph.SubscriptionsUtility%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                      <h1 id="PnP_Framework_Graph_SubscriptionsUtility" data-uid="PnP.Framework.Graph.SubscriptionsUtility">Class SubscriptionsUtility
  </h1>
  <div class="markdown level0 summary"><p>Class that deals with Microsoft Graph Subscriptions</p>
</div>
  <div class="markdown level0 conceptual"></div>

  <div class="inheritance">
    <h5>Inheritance</h5>
    <div class="level0"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">Object</a></div>
    <div class="level1"><span class="xref">SubscriptionsUtility</span></div>
  </div>
  
  
  
  <h6><strong>Namespace</strong>: <a class="xref" href="PnP.Framework.Graph.html">PnP.Framework.Graph</a></h6>
  <h6><strong>Assembly</strong>: PnP.Framework.dll</h6>
  
  <h5 id="PnP_Framework_Graph_SubscriptionsUtility_syntax">Syntax</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static class SubscriptionsUtility : object</code></pre>
  </div>

  
  
  
  
  <h3 id="methods">Methods
  </h3>
  
  <span class="small pull-right mobile-hide">
    <span class="divider"> </span>
    <a href="https://github.com/pnp/pnpframework/new/dev/apiSpec/new?filename=PnP_Framework_Graph_SubscriptionsUtility_CreateSubscription_PnP_Framework_Enums_GraphSubscriptionChangeType_System_String_System_String_DateTimeOffset_System_String_System_String_PnP_Framework_Enums_GraphSubscriptionTlsVersion_System_Int32_System_Int32_PnP_Framework_AzureEnvironment_.md&amp;value=---%0Auid%3A%20PnP.Framework.Graph.SubscriptionsUtility.CreateSubscription(PnP.Framework.Enums.GraphSubscriptionChangeType%2CSystem.String%2CSystem.String%2CDateTimeOffset%2CSystem.String%2CSystem.String%2CPnP.Framework.Enums.GraphSubscriptionTlsVersion%2CSystem.Int32%2CSystem.Int32%2CPnP.Framework.AzureEnvironment)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A" title="Improve this Doc"><i class="fa fa-pencil"></i></a>
  </span>
  <span class="small pull-right mobile-hide">
    <a href="https://github.com/pnp/pnpframework/blob/dev/src/lib/PnP.Framework/Graph/SubscriptionsUtility.cs/#L136" title="View Source"><i class="fa fa-code"></i></a>
  </span>
  
  <a id="PnP_Framework_Graph_SubscriptionsUtility_CreateSubscription_" data-uid="PnP.Framework.Graph.SubscriptionsUtility.CreateSubscription*"></a>
  
  <h4 id="PnP_Framework_Graph_SubscriptionsUtility_CreateSubscription_PnP_Framework_Enums_GraphSubscriptionChangeType_System_String_System_String_DateTimeOffset_System_String_System_String_PnP_Framework_Enums_GraphSubscriptionTlsVersion_System_Int32_System_Int32_PnP_Framework_AzureEnvironment_" data-uid="PnP.Framework.Graph.SubscriptionsUtility.CreateSubscription(PnP.Framework.Enums.GraphSubscriptionChangeType,System.String,System.String,DateTimeOffset,System.String,System.String,PnP.Framework.Enums.GraphSubscriptionTlsVersion,System.Int32,System.Int32,PnP.Framework.AzureEnvironment)"><a href="#collapsible-PnP_Framework_Graph_SubscriptionsUtility_CreateSubscription_PnP_Framework_Enums_GraphSubscriptionChangeType_System_String_System_String_DateTimeOffset_System_String_System_String_PnP_Framework_Enums_GraphSubscriptionTlsVersion_System_Int32_System_Int32_PnP_Framework_AzureEnvironment_" class="expander" data-toggle="collapse">CreateSubscription(GraphSubscriptionChangeType, String, String, DateTimeOffset, String, String, GraphSubscriptionTlsVersion, Int32, Int32, AzureEnvironment)</a></h4>
  
  <div id="collapsible-PnP_Framework_Graph_SubscriptionsUtility_CreateSubscription_PnP_Framework_Enums_GraphSubscriptionChangeType_System_String_System_String_DateTimeOffset_System_String_System_String_PnP_Framework_Enums_GraphSubscriptionTlsVersion_System_Int32_System_Int32_PnP_Framework_AzureEnvironment_" class="collapse in">
  <div class="markdown level1 summary"><p>Creates a new Microsoft Graph Subscription</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static Subscription CreateSubscription(GraphSubscriptionChangeType changeType, string notificationUrl, string resource, DateTimeOffset expirationDateTime, string clientState, string accessToken, GraphSubscriptionTlsVersion latestSupportedTlsVersion = GraphSubscriptionTlsVersion.v1_2, int retryCount = 10, int delay = 500, AzureEnvironment azureEnvironment = default(AzureEnvironment))</code></pre>
  </div>

  <h5 class="parameters">Parameters</h5>
  <table>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="PnP.Framework.Enums.GraphSubscriptionChangeType.html">GraphSubscriptionChangeType</a></span>
        <span class="parametername">changeType</span>
        <p><p>The event(s) the subscription should trigger on</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">String</a></span>
        <span class="parametername">notificationUrl</span>
        <p><p>The URL that should be called when an event matching this subscription occurs</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">String</a></span>
        <span class="parametername">resource</span>
        <p><p>The resource to monitor for changes. See <a href="https://docs.microsoft.com/graph/api/subscription-post-subscriptions#permissions">https://docs.microsoft.com/graph/api/subscription-post-subscriptions#permissions</a> for the list with supported options.</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><span class="xref">DateTimeOffset</span></span>
        <span class="parametername">expirationDateTime</span>
        <p><p>The datetime defining how long this subscription should stay alive before which it needs to get extended to stay alive. See <a href="https://docs.microsoft.com/graph/api/resources/subscription#maximum-length-of-subscription-per-resource-type">https://docs.microsoft.com/graph/api/resources/subscription#maximum-length-of-subscription-per-resource-type</a> for the supported maximum lifetime of the subscriber endpoints.</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">String</a></span>
        <span class="parametername">clientState</span>
        <p><p>Specifies the value of the clientState property sent by the service in each notification. The maximum length is 128 characters. The client can check that the notification came from the service by comparing the value of the clientState property sent with the subscription with the value of the clientState property received with each notification.</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">String</a></span>
        <span class="parametername">accessToken</span>
        <p><p>The OAuth 2.0 Access Token to use for invoking the Microsoft Graph</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="PnP.Framework.Enums.GraphSubscriptionTlsVersion.html">GraphSubscriptionTlsVersion</a></span>
        <span class="parametername">latestSupportedTlsVersion</span>
        <p><p>Specifies the latest version of Transport Layer Security (TLS) that the notification endpoint, specified by <code data-dev-comment-type="paramref" class="paramref">notificationUrl</code>, supports. If not provided, TLS 1.2 will be assumed.</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">Int32</a></span>
        <span class="parametername">retryCount</span>
        <p><p>Number of times to retry the request in case of throttling</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">Int32</a></span>
        <span class="parametername">delay</span>
        <p><p>Milliseconds to wait before retrying the request. The delay will be increased (doubled) every retry</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="PnP.Framework.AzureEnvironment.html">AzureEnvironment</a></span>
        <span class="parametername">azureEnvironment</span>
        <p><p>Defines the Azure Cloud Deployment. This is used to determine the MS Graph EndPoint to call which differs per Azure Cloud deployments. Defaults to Production (graph.microsoft.com).</p>
</p>
      </td>
    </tr>
  </table>
  
  <h5 class="returns">Returns</h5>
  <table>
    <tr>
      <td>
        <a class="xref" href="PnP.Framework.Graph.Model.Subscription.html">Subscription</a>
        <p><p>The just created Microsoft Graph subscription</p>
</p>
      </td>
    </tr>
  </table>
  
  
  
  
  
  
  
  
  
  
  </div>
  
  <span class="small pull-right mobile-hide">
    <span class="divider"> </span>
    <a href="https://github.com/pnp/pnpframework/new/dev/apiSpec/new?filename=PnP_Framework_Graph_SubscriptionsUtility_DeleteSubscription_System_String_System_String_System_Int32_System_Int32_.md&amp;value=---%0Auid%3A%20PnP.Framework.Graph.SubscriptionsUtility.DeleteSubscription(System.String%2CSystem.String%2CSystem.Int32%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A" title="Improve this Doc"><i class="fa fa-pencil"></i></a>
  </span>
  <span class="small pull-right mobile-hide">
    <a href="https://github.com/pnp/pnpframework/blob/dev/src/lib/PnP.Framework/Graph/SubscriptionsUtility.cs/#L251" title="View Source"><i class="fa fa-code"></i></a>
  </span>
  
  <a id="PnP_Framework_Graph_SubscriptionsUtility_DeleteSubscription_" data-uid="PnP.Framework.Graph.SubscriptionsUtility.DeleteSubscription*"></a>
  
  <h4 id="PnP_Framework_Graph_SubscriptionsUtility_DeleteSubscription_System_String_System_String_System_Int32_System_Int32_" data-uid="PnP.Framework.Graph.SubscriptionsUtility.DeleteSubscription(System.String,System.String,System.Int32,System.Int32)"><a href="#collapsible-PnP_Framework_Graph_SubscriptionsUtility_DeleteSubscription_System_String_System_String_System_Int32_System_Int32_" class="expander" data-toggle="collapse">DeleteSubscription(String, String, Int32, Int32)</a></h4>
  
  <div id="collapsible-PnP_Framework_Graph_SubscriptionsUtility_DeleteSubscription_System_String_System_String_System_Int32_System_Int32_" class="collapse in">
  <div class="markdown level1 summary"><p>Deletes an existing Microsoft Graph Subscription</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static void DeleteSubscription(string subscriptionId, string accessToken, int retryCount = 10, int delay = 500)</code></pre>
  </div>

  <h5 class="parameters">Parameters</h5>
  <table>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">String</a></span>
        <span class="parametername">subscriptionId</span>
        <p><p>Unique identifier of the Microsoft Graph subscription</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">String</a></span>
        <span class="parametername">accessToken</span>
        <p><p>The OAuth 2.0 Access Token to use for invoking the Microsoft Graph</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">Int32</a></span>
        <span class="parametername">retryCount</span>
        <p><p>Number of times to retry the request in case of throttling</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">Int32</a></span>
        <span class="parametername">delay</span>
        <p><p>Milliseconds to wait before retrying the request. The delay will be increased (doubled) every retry</p>
</p>
      </td>
    </tr>
  </table>
  
  
  
  
  
  
  
  
  
  
  
  </div>
  
  <span class="small pull-right mobile-hide">
    <span class="divider"> </span>
    <a href="https://github.com/pnp/pnpframework/new/dev/apiSpec/new?filename=PnP_Framework_Graph_SubscriptionsUtility_GetSubscription_System_String_Guid_System_Int32_System_Int32_System_Int32_System_Int32_PnP_Framework_AzureEnvironment_.md&amp;value=---%0Auid%3A%20PnP.Framework.Graph.SubscriptionsUtility.GetSubscription(System.String%2CGuid%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CPnP.Framework.AzureEnvironment)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A" title="Improve this Doc"><i class="fa fa-pencil"></i></a>
  </span>
  <span class="small pull-right mobile-hide">
    <a href="https://github.com/pnp/pnpframework/blob/dev/src/lib/PnP.Framework/Graph/SubscriptionsUtility.cs/#L26" title="View Source"><i class="fa fa-code"></i></a>
  </span>
  
  <a id="PnP_Framework_Graph_SubscriptionsUtility_GetSubscription_" data-uid="PnP.Framework.Graph.SubscriptionsUtility.GetSubscription*"></a>
  
  <h4 id="PnP_Framework_Graph_SubscriptionsUtility_GetSubscription_System_String_Guid_System_Int32_System_Int32_System_Int32_System_Int32_PnP_Framework_AzureEnvironment_" data-uid="PnP.Framework.Graph.SubscriptionsUtility.GetSubscription(System.String,Guid,System.Int32,System.Int32,System.Int32,System.Int32,PnP.Framework.AzureEnvironment)"><a href="#collapsible-PnP_Framework_Graph_SubscriptionsUtility_GetSubscription_System_String_Guid_System_Int32_System_Int32_System_Int32_System_Int32_PnP_Framework_AzureEnvironment_" class="expander" data-toggle="collapse">GetSubscription(String, Guid, Int32, Int32, Int32, Int32, AzureEnvironment)</a></h4>
  
  <div id="collapsible-PnP_Framework_Graph_SubscriptionsUtility_GetSubscription_System_String_Guid_System_Int32_System_Int32_System_Int32_System_Int32_PnP_Framework_AzureEnvironment_" class="collapse in">
  <div class="markdown level1 summary"><p>Returns the subscription with the provided subscriptionId from Microsoft Graph</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static Subscription GetSubscription(string accessToken, Guid subscriptionId, int startIndex = 0, int endIndex = 999, int retryCount = 10, int delay = 500, AzureEnvironment azureEnvironment = default(AzureEnvironment))</code></pre>
  </div>

  <h5 class="parameters">Parameters</h5>
  <table>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">String</a></span>
        <span class="parametername">accessToken</span>
        <p><p>The OAuth 2.0 Access Token to use for invoking the Microsoft Graph</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><span class="xref">Guid</span></span>
        <span class="parametername">subscriptionId</span>
        <p><p>The unique identifier of the subscription to return from Microsoft Graph</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">Int32</a></span>
        <span class="parametername">startIndex</span>
        <p><p>First item in the results returned by Microsoft Graph to return</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">Int32</a></span>
        <span class="parametername">endIndex</span>
        <p><p>Last item in the results returned by Microsoft Graph to return</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">Int32</a></span>
        <span class="parametername">retryCount</span>
        <p><p>Number of times to retry the request in case of throttling</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">Int32</a></span>
        <span class="parametername">delay</span>
        <p><p>Milliseconds to wait before retrying the request. The delay will be increased (doubled) every retry.</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="PnP.Framework.AzureEnvironment.html">AzureEnvironment</a></span>
        <span class="parametername">azureEnvironment</span>
        <p><p>Defines the Azure Cloud Deployment. This is used to determine the MS Graph EndPoint to call which differs per Azure Cloud deployments. Defaults to Production (graph.microsoft.com).</p>
</p>
      </td>
    </tr>
  </table>
  
  <h5 class="returns">Returns</h5>
  <table>
    <tr>
      <td>
        <a class="xref" href="PnP.Framework.Graph.Model.Subscription.html">Subscription</a>
        <p><p>Subscription object</p>
</p>
      </td>
    </tr>
  </table>
  
  
  
  
  
  
  
  
  
  
  </div>
  
  <span class="small pull-right mobile-hide">
    <span class="divider"> </span>
    <a href="https://github.com/pnp/pnpframework/new/dev/apiSpec/new?filename=PnP_Framework_Graph_SubscriptionsUtility_ListSubscriptions_System_String_System_Int32_System_Int32_System_Int32_System_Int32_PnP_Framework_AzureEnvironment_.md&amp;value=---%0Auid%3A%20PnP.Framework.Graph.SubscriptionsUtility.ListSubscriptions(System.String%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CPnP.Framework.AzureEnvironment)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A" title="Improve this Doc"><i class="fa fa-pencil"></i></a>
  </span>
  <span class="small pull-right mobile-hide">
    <a href="https://github.com/pnp/pnpframework/blob/dev/src/lib/PnP.Framework/Graph/SubscriptionsUtility.cs/#L62" title="View Source"><i class="fa fa-code"></i></a>
  </span>
  
  <a id="PnP_Framework_Graph_SubscriptionsUtility_ListSubscriptions_" data-uid="PnP.Framework.Graph.SubscriptionsUtility.ListSubscriptions*"></a>
  
  <h4 id="PnP_Framework_Graph_SubscriptionsUtility_ListSubscriptions_System_String_System_Int32_System_Int32_System_Int32_System_Int32_PnP_Framework_AzureEnvironment_" data-uid="PnP.Framework.Graph.SubscriptionsUtility.ListSubscriptions(System.String,System.Int32,System.Int32,System.Int32,System.Int32,PnP.Framework.AzureEnvironment)"><a href="#collapsible-PnP_Framework_Graph_SubscriptionsUtility_ListSubscriptions_System_String_System_Int32_System_Int32_System_Int32_System_Int32_PnP_Framework_AzureEnvironment_" class="expander" data-toggle="collapse">ListSubscriptions(String, Int32, Int32, Int32, Int32, AzureEnvironment)</a></h4>
  
  <div id="collapsible-PnP_Framework_Graph_SubscriptionsUtility_ListSubscriptions_System_String_System_Int32_System_Int32_System_Int32_System_Int32_PnP_Framework_AzureEnvironment_" class="collapse in">
  <div class="markdown level1 summary"><p>Returns all the active Microsoft Graph subscriptions</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static List&lt;Subscription&gt; ListSubscriptions(string accessToken, int startIndex = 0, int endIndex = 999, int retryCount = 10, int delay = 500, AzureEnvironment azureEnvironment = default(AzureEnvironment))</code></pre>
  </div>

  <h5 class="parameters">Parameters</h5>
  <table>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">String</a></span>
        <span class="parametername">accessToken</span>
        <p><p>The OAuth 2.0 Access Token to use for invoking the Microsoft Graph</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">Int32</a></span>
        <span class="parametername">startIndex</span>
        <p><p>First item in the results returned by Microsoft Graph to return</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">Int32</a></span>
        <span class="parametername">endIndex</span>
        <p><p>Last item in the results returned by Microsoft Graph to return</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">Int32</a></span>
        <span class="parametername">retryCount</span>
        <p><p>Number of times to retry the request in case of throttling</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">Int32</a></span>
        <span class="parametername">delay</span>
        <p><p>Milliseconds to wait before retrying the request. The delay will be increased (doubled) every retry.</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="PnP.Framework.AzureEnvironment.html">AzureEnvironment</a></span>
        <span class="parametername">azureEnvironment</span>
        <p><p>Defines the Azure Cloud Deployment. This is used to determine the MS Graph EndPoint to call which differs per Azure Cloud deployments. Defaults to Production (graph.microsoft.com).</p>
</p>
      </td>
    </tr>
  </table>
  
  <h5 class="returns">Returns</h5>
  <table>
    <tr>
      <td>
        <span class="xref">List</span>&lt;<a class="xref" href="PnP.Framework.Graph.Model.Subscription.html">Subscription</a>&gt;
        <p><p>List with Subscription objects</p>
</p>
      </td>
    </tr>
  </table>
  
  
  
  
  
  
  
  
  
  
  </div>
  
  <span class="small pull-right mobile-hide">
    <span class="divider"> </span>
    <a href="https://github.com/pnp/pnpframework/new/dev/apiSpec/new?filename=PnP_Framework_Graph_SubscriptionsUtility_UpdateSubscription_System_String_DateTimeOffset_System_String_System_Int32_System_Int32_PnP_Framework_AzureEnvironment_.md&amp;value=---%0Auid%3A%20PnP.Framework.Graph.SubscriptionsUtility.UpdateSubscription(System.String%2CDateTimeOffset%2CSystem.String%2CSystem.Int32%2CSystem.Int32%2CPnP.Framework.AzureEnvironment)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A" title="Improve this Doc"><i class="fa fa-pencil"></i></a>
  </span>
  <span class="small pull-right mobile-hide">
    <a href="https://github.com/pnp/pnpframework/blob/dev/src/lib/PnP.Framework/Graph/SubscriptionsUtility.cs/#L200" title="View Source"><i class="fa fa-code"></i></a>
  </span>
  
  <a id="PnP_Framework_Graph_SubscriptionsUtility_UpdateSubscription_" data-uid="PnP.Framework.Graph.SubscriptionsUtility.UpdateSubscription*"></a>
  
  <h4 id="PnP_Framework_Graph_SubscriptionsUtility_UpdateSubscription_System_String_DateTimeOffset_System_String_System_Int32_System_Int32_PnP_Framework_AzureEnvironment_" data-uid="PnP.Framework.Graph.SubscriptionsUtility.UpdateSubscription(System.String,DateTimeOffset,System.String,System.Int32,System.Int32,PnP.Framework.AzureEnvironment)"><a href="#collapsible-PnP_Framework_Graph_SubscriptionsUtility_UpdateSubscription_System_String_DateTimeOffset_System_String_System_Int32_System_Int32_PnP_Framework_AzureEnvironment_" class="expander" data-toggle="collapse">UpdateSubscription(String, DateTimeOffset, String, Int32, Int32, AzureEnvironment)</a></h4>
  
  <div id="collapsible-PnP_Framework_Graph_SubscriptionsUtility_UpdateSubscription_System_String_DateTimeOffset_System_String_System_Int32_System_Int32_PnP_Framework_AzureEnvironment_" class="collapse in">
  <div class="markdown level1 summary"><p>Updates an existing Microsoft Graph Subscription</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static Subscription UpdateSubscription(string subscriptionId, DateTimeOffset expirationDateTime, string accessToken, int retryCount = 10, int delay = 500, AzureEnvironment azureEnvironment = default(AzureEnvironment))</code></pre>
  </div>

  <h5 class="parameters">Parameters</h5>
  <table>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">String</a></span>
        <span class="parametername">subscriptionId</span>
        <p><p>Unique identifier of the Microsoft Graph subscription</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><span class="xref">DateTimeOffset</span></span>
        <span class="parametername">expirationDateTime</span>
        <p><p>The datetime defining how long this subscription should stay alive before which it needs to get extended to stay alive. See <a href="https://docs.microsoft.com/graph/api/resources/subscription#maximum-length-of-subscription-per-resource-type">https://docs.microsoft.com/graph/api/resources/subscription#maximum-length-of-subscription-per-resource-type</a> for the supported maximum lifetime of the subscriber endpoints.</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">String</a></span>
        <span class="parametername">accessToken</span>
        <p><p>The OAuth 2.0 Access Token to use for invoking the Microsoft Graph</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">Int32</a></span>
        <span class="parametername">retryCount</span>
        <p><p>Number of times to retry the request in case of throttling</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">Int32</a></span>
        <span class="parametername">delay</span>
        <p><p>Milliseconds to wait before retrying the request. The delay will be increased (doubled) every retry</p>
</p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="pull-right"><a class="xref" href="PnP.Framework.AzureEnvironment.html">AzureEnvironment</a></span>
        <span class="parametername">azureEnvironment</span>
        <p><p>Defines the Azure Cloud Deployment. This is used to determine the MS Graph EndPoint to call which differs per Azure Cloud deployments. Defaults to Production (graph.microsoft.com).</p>
</p>
      </td>
    </tr>
  </table>
  
  <h5 class="returns">Returns</h5>
  <table>
    <tr>
      <td>
        <a class="xref" href="PnP.Framework.Graph.Model.Subscription.html">Subscription</a>
        <p><p>The just updated Microsoft Graph subscription</p>
</p>
      </td>
    </tr>
  </table>
  
  
  
  
  
  
  
  
  
  
  </div>
  
  
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>PnP Framework<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <img src="https://pnptelemetry.azurewebsites.net/pnpframework" alt="spacer">
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>  </body>
</html>